name: Release

on:
   push:
      branches:
         - main

permissions:
   contents: write

concurrency:
   group: release-${{ github.ref }}
   cancel-in-progress: true

jobs:
   release:
      runs-on: ubuntu-latest
      env:
         GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
         NPM_TOKEN: ${{ secrets.NPM_TOKEN }}
      steps:
         - uses: actions/checkout@v3
         - uses: jdx/mise-action@v2
         - run: echo "//registry.npmjs.org/:_authToken=${NPM_TOKEN}" > ~/.npmrc
         - run: mise run package
